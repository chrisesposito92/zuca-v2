---
title: "Configure an Aggregator as a processor"
url: "https://docs.zuora.com/en/zuora-platform/extensibility/mediation/meter-components/configure-an-aggregator-as-a-processor"
product: "zuora-platform"
scraped_at: "2026-01-15T22:00:43.765Z"
---

# Configure an Aggregator as a processor

Learn how to configure an Aggregator as a processor to perform aggregation functions and sort input events.

You can include an aggregator processor that sums up, returns the average value of usage data, or performs other pre-defined aggregation functions. You can also include code for custom aggregation functions.

The Aggregator processor supports sorting input events by a specified field before aggregation. This feature applies only to batch-mode meters and ensures consistent, predictable ordering of events within each key group. A single field name will be used for sorting. The field must be convertible to an unsigned long like epoch timestamp, numerical sequence, etc. Both ascending order and descending order are supported. Sorting is applied within each key group (for example, events grouped by `accountNumber` or `chargeNumber`). To sort all events across accounts, set key field = "" or use a constant like "global".

The following example illustrates sorting within the key group by eventTime. If `eventTime` is used as the Sort Field and `accountNumber` is the key, the Aggregator will sort all events for each account by timestamp before performing aggregation.

Input:\[ { "accountNumber": "ACC-001", "eventTime": 1718203000, "usage": 8 }, { "accountNumber": "ACC-001", "eventTime": 1718201000, "usage": 2 }, { "accountNumber": "ACC-002", "eventTime": 1718202000, "usage": 5 }, { "accountNumber": "ACC-002", "eventTime": 1718204000, "usage": 3 } \]

Output: { "ACC-001": \[ { "eventTime": 1718201000, "usage": 2 }, { "eventTime": 1718203000, "usage": 8 } \], "ACC-002": \[ { "eventTime": 1718202000, "usage": 5 }, { "eventTime": 1718204000, "usage": 3 } \] }

This feature is only available in batch mode. Batch mode meters are defined as no Kafka source, no Streaming API, no incremental S3 source. For example an S3 source + Kafka sink is not supported. In such cases, consider changing the sink to S3, Event Store, or Zuora Usage.

To create a meter with an Aggregator as the processor:

1.  Create a Custom Meter . For more information, see Create a new meter using custom method.
2.  Select Aggregator as the processor. The Aggregator settings page is displayed.

    ![Aggregator processor fields](https://zuora.deploy.heretto.com/v4/deployments/QPAZk6lsgXwvotedNERE/object/e4a86998-6164-4f43-9dc0-b18752b83824?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJodHRwczovL2pvcnNlay5jb20vZXpkX29yZ2FuaXphdGlvbiI6Inp1b3JhIiwiaHR0cHM6Ly9qb3JzZWsuY29tL2V6ZC9vYmplY3RfdXVpZCI6ImU0YTg2OTk4LTYxNjQtNGY0My05ZGMwLWIxODc1MmI4MzgyNCIsImV4cCI6MTc2ODYwMDgzNywianRpIjoiODU3ZjNkY2I4MWRlNGQ1ZjllNWQxYmMwYzIxYWM1MDMiLCJodHRwczovL2pvcnNlay5jb20vZXpkX2ZpbGVzZXQiOiI4RWFZRjVFNjZLaVRYdnNmS3N5NSJ9.oVKurf_8IBflwGV-g_GIRlihoB1fpBZfWXwh_4oNy9I)

3.  Enter a name for the aggregator component.
4.  Select the group by fields.
5.  Select the aggregate options.
    1.  Aggregate Fields : You can define the source field, operator, and result field. Create a new field if you want to use a new name or overwrite the source field if using the same name as source field.

        1.  The aggregator will use “group by fields” to generate the usage unique key, which will be used to update the usage records in billing if the usage unique key is the same.
        2.  The aggregator will not reduce the record rows but only add the results fields value based on the operation results. Then those usage records with the same unique key generated by the same “group by fields” can be transferred to billing and update the usage records with the aggregation results.
        3.  The source field will be removed if the result field is using a new field name.

    2.  Advanced Aggregation: You can set a complex Javascript or Python code to process the events.
6.  Click Save to save the aggregator processor settings.

The aggregator processor meter component is configured.
