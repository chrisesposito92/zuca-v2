---
title: "Sample queries"
url: "https://docs.zuora.com/en/zuora-revenue/advanced-revenue-operations/zuora-revenue-bi-views/sample-queries"
product: "zuora-revenue"
scraped_at: "2026-02-19T03:40:30.930Z"
---

# Sample queries

This document provides examples and explanations on using various queries to generate different reports, including sample codes and diagrams illustrating table relationships.

Examples are provided in the following sections to explain how to use different queries to derive different reports. In these examples, you can see how data points from various data entities are combined to adapt to different reporting scenarios.

Sample codes and a diagram to illustrate the relationship between the related tables are present for each example.

## Booking

SELECT RB.NAME AS BOOK\_NAME, RC.ID AS RC\_ID, POB.RC\_POB\_NAME, DECODE (POB.LEAD\_LINE\_ID, RCL.ID, 'Y', 'N') AS LEAD\_LINE, RCL.CSTMR\_NM, RCL.CT\_DATE, RCL.CT\_NUM, RCL.CT\_LINE\_NUM, RCL.SO\_BOOK\_DATE, RCL.SO\_NUM, RCL.SO\_LINE\_NUM, RCL.TYPE, RCL.ITEM\_NUM, RCL.EXT\_SLL\_PRC, RCL.EXT\_FV\_PRC, RCL.DEF\_AMT, RCL.REC\_AMT, RCL.BLD\_DEF\_AMT, RCL.BLD\_REC\_AMT FROM RPRO\_BI3\_RC\_LNS\_V RCL, RPRO\_BI3\_RC\_HEAD\_V RC, RPRO\_BI3\_RC\_POB\_V POB, RPRO\_BI3\_BOOK\_V RB, RPRO\_BI3\_ORG\_V ORG WHERE RCL.RC\_ID = RC.ID AND RCL.RC\_POB\_ID = POB.RC\_POB\_ID(+) AND RCL.BOOK\_ID = RB.ID AND RCL.BOOK\_ID = RC.BOOK\_ID AND RCL.SEC\_ATR\_VAL = ORG.ORG\_ID ORDER BY RC.ID;

![booking.png](https://zuora.deploy.heretto.com/v4/deployments/QPAZk6lsgXwvotedNERE/object/a4775b69-6492-4acd-b40a-2fb1be2568bb?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJodHRwczovL2pvcnNlay5jb20vZXpkX29yZ2FuaXphdGlvbiI6Inp1b3JhIiwiaHR0cHM6Ly9qb3JzZWsuY29tL2V6ZC9vYmplY3RfdXVpZCI6ImE0Nzc1YjY5LTY0OTItNGFjZC1iNDBhLTJmYjFiZTI1NjhiYiIsImV4cCI6MTc3MTU1ODgyMywianRpIjoiNWFjNWZjMGM5NTYwNGU2MjhlNzViNTM5MTExNGZjMTQiLCJodHRwczovL2pvcnNlay5jb20vZXpkX2ZpbGVzZXQiOiJPbkFzQUJUb1lNdVNnalRaVHpuUCJ9.YVQK7g65FTQOZzjdOJI8BfgQUbhkuf92k7XSFyKhOkM) .

## Billing

SELECT RB.NAME AS BOOK\_NAME, RC.ID AS RC\_ID, POB.RC\_POB\_NAME, DECODE (POB.LEAD\_LINE\_ID, RCL.ID, 'Y', 'N') AS LEAD\_LINE, RCL.CSTMR\_NM, RCL.CT\_DATE, RCL.CT\_NUM, RCL.CT\_LINE\_NUM, RCL.SO\_BOOK\_DATE, RCL.SO\_NUM, RCL.SO\_LINE\_NUM, RCL.TYPE, RCL.ITEM\_NUM, RCL.EXT\_SLL\_PRC, RCL.EXT\_FV\_PRC, RCL.DEF\_AMT, RCL.REC\_AMT, RCL.BLD\_DEF\_AMT, RCL.BLD\_REC\_AMT, RRB.INVOICE\_NUM, RRB.INVOICE\_LINE\_NUM, RRB.TYPE BILL\_TYPE, RRB.INVOICE\_DATE, RRB.EXT\_SLL\_PRC INVOICE\_SELL\_PRICE, RRB.DEF\_AMT INVOICE\_DEF\_AMT, RRB.REC\_AMT INVOICE\_REC\_AMT FROM RPRO\_BI3\_RC\_BILL\_V RRB, RPRO\_BI3\_RC\_LNS\_V RCL, RPRO\_BI3\_RC\_HEAD\_V RC, RPRO\_BI3\_RC\_POB\_V POB, RPRO\_BI3\_BOOK\_V RB, RPRO\_BI3\_ORG\_V ORG WHERE RCL.RC\_ID = RC.ID AND RRB.LINE\_ID = RCL.ID AND RCL.RC\_POB\_ID = POB.RC\_POB\_ID(+) AND RCL.BOOK\_ID = RB.ID AND RCL.BOOK\_ID = RC.BOOK\_ID AND RCL.SEC\_ATR\_VAL = ORG.ORG\_ID ORDER BY RC.ID;

![billing.png](https://zuora.deploy.heretto.com/v4/deployments/QPAZk6lsgXwvotedNERE/object/4e2b6227-0740-48b1-92ec-6b62d0f61542?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJodHRwczovL2pvcnNlay5jb20vZXpkX29yZ2FuaXphdGlvbiI6Inp1b3JhIiwiaHR0cHM6Ly9qb3JzZWsuY29tL2V6ZC9vYmplY3RfdXVpZCI6IjRlMmI2MjI3LTA3NDAtNDhiMS05MmVjLTZiNjJkMGY2MTU0MiIsImV4cCI6MTc3MTU1ODgyMywianRpIjoiYTc4NDMwMTEzOTM1NDA1NDk1YzMwNWRiYTJhMDA4NWYiLCJodHRwczovL2pvcnNlay5jb20vZXpkX2ZpbGVzZXQiOiJPbkFzQUJUb1lNdVNnalRaVHpuUCJ9.CV8HpGBIwlhDnaaB9zOH1kEy99Cdb3TcvzhCgdnVcfU)

## Cost

SELECT RB.NAME AS BOOK\_NAME, ORG.ORG\_NAME, RC.ID AS RC\_ID, POB.RC\_POB\_NAME, DECODE (POB.LEAD\_LINE\_ID, RCL.ID, 'Y', 'N') AS LEAD\_LINE, RCL.CSTMR\_NM, RCL.CT\_DATE, RCL.CT\_NUM, RCL.CT\_LINE\_NUM, RCL.SO\_BOOK\_DATE, RCL.SO\_NUM, RCL.SO\_LINE\_NUM, RCL.EXT\_LST\_PRC, RCL.EXT\_SLL\_PRC, RLC.COST\_TYPE, RLC.ITEM\_NUM, RLC.AMOUNT, RLC.DEF\_AMT AS COST\_DEF\_AMT, RLC.REC\_AMT AS COST\_REC\_AMT, RLC.COST\_TMPL\_NAME FROM RPRO\_BI3\_RC\_LN\_COST\_V RLC, RPRO\_BI3\_RC\_LNS\_V RCL, RPRO\_BI3\_RC\_HEAD\_V RC, RPRO\_BI3\_RC\_POB\_V POB, RPRO\_BI3\_BOOK\_V RB, RPRO\_BI3\_ORG\_V ORG WHERE RLC.LINE\_ID = RCL.ID AND RLC.BOOK\_ID = RCL.BOOK\_ID AND RCL.RC\_ID = RC.ID AND RCL.RC\_POB\_ID = POB.RC\_POB\_ID(+) AND RCL.BOOK\_ID = RB.ID AND RCL.BOOK\_ID = RC.BOOK\_ID AND RCL.SEC\_ATR\_VAL = ORG.ORG\_ID ORDER BY RB.NAME, RC.ID, RCL.SO\_NUM, RCL.SO\_LINE\_NUM;

## Revenue waterfall

SELECT RB.NAME AS BOOK\_NAME, ORG.ORG\_NAME, RC.ID AS RC\_ID, POB.RC\_POB\_NAME, RCL.CSTMR\_NM, RCL.SO\_BOOK\_DATE, RCL.SO\_NUM, RCL.SO\_LINE\_NUM, WF.ACCTG\_SEG, WF.ACCTG\_TYPE\_ID, ACT.NAME, CAL.PERIOD\_NAME, SUM(WF.F\_AT) AMOUNT\_IN\_FUNC\_CURR FROM RPRO\_BI3\_WF\_SUMM\_V WF, RPRO\_BI3\_ACCT\_TYPE\_V ACT, RPRO\_BI3\_RC\_LNS\_V RCL, RPRO\_BI3\_RC\_HEAD\_V RC, RPRO\_BI3\_RC\_POB\_V POB, RPRO\_BI3\_BOOK\_V RB, RPRO\_BI3\_ORG\_V ORG, RPRO\_BI3\_CALENDAR\_V CAL WHERE WF.ROOT\_LINE\_ID = RCL.ID AND WF.BOOK\_ID = RB.ID AND WF.ACCTG\_TYPE\_ID = ACT.ID AND WF.SEC\_ATR\_VAL = ORG.ORG\_ID AND RCL.RC\_ID = RC.ID AND RCL.RC\_POB\_ID = POB.RC\_POB\_ID(+) AND RCL.BOOK\_ID = RC.BOOK\_ID AND ACT.WATERFALL\_FLAG = 'Y' AND ACT.COST\_FLAG = 'N' AND WF.PRD\_ID = CAL.ID AND WF.AS\_OF\_PRD\_ID = 201904 GROUP BY RB.NAME, ORG.ORG\_NAME, RC.ID, POB.RC\_POB\_NAME, RCL.CSTMR\_NM, RCL.SO\_BOOK\_DATE, RCL.SO\_NUM, RCL.SO\_LINE\_NUM, WF.ACCTG\_SEG, WF.ACCTG\_TYPE\_ID, ACT.NAME, CAL.PERIOD\_NAME, WF.PRD\_ID ORDER BY RB.NAME, RC.ID, RCL.SO\_NUM, RCL.SO\_LINE\_NUM, ACT.NAME, WF.PRD\_ID;

![revenue-waterfall.png](https://zuora.deploy.heretto.com/v4/deployments/QPAZk6lsgXwvotedNERE/object/f49bdd6c-f6d9-4066-9018-d515228a4385?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJodHRwczovL2pvcnNlay5jb20vZXpkX29yZ2FuaXphdGlvbiI6Inp1b3JhIiwiaHR0cHM6Ly9qb3JzZWsuY29tL2V6ZC9vYmplY3RfdXVpZCI6ImY0OWJkZDZjLWY2ZDktNDA2Ni05MDE4LWQ1MTUyMjhhNDM4NSIsImV4cCI6MTc3MTU1ODgyMywianRpIjoiZmU4ZWZiNzU1ZDkwNDc3ZjkxZGMzOTY1NmU5YmE4YWYiLCJodHRwczovL2pvcnNlay5jb20vZXpkX2ZpbGVzZXQiOiJPbkFzQUJUb1lNdVNnalRaVHpuUCJ9.eUGaZJ9aeS8M0byuSsxH6Dxne9ObfzAJcPWu5ubO3-k) .

## Cost waterfall

SELECT RB.NAME AS BOOK\_NAME, ORG.ORG\_NAME, RC.ID AS RC\_ID, POB.RC\_POB\_NAME, RCL.CSTMR\_NM, RCL.SO\_BOOK\_DATE, RCL.SO\_NUM, RCL.SO\_LINE\_NUM, WF.ACCTG\_SEG, WF.ACCTG\_TYPE\_ID, ACT.NAME, CAL.PERIOD\_NAME, SUM(WF.F\_AT) AMOUNT\_IN\_FUNC\_CURR FROM RPRO\_BI3\_WF\_SUMM\_V WF, RPRO\_BI3\_ACCT\_TYPE\_V ACT, RPRO\_BI3\_RC\_LNS\_V RCL, RPRO\_BI3\_RC\_HEAD\_V RC, RPRO\_BI3\_RC\_POB\_V POB, RPRO\_BI3\_BOOK\_V RB, RPRO\_BI3\_ORG\_V ORG, RPRO\_BI3\_CALENDAR\_V CAL WHERE WF.ROOT\_LINE\_ID = RCL.ID AND WF.BOOK\_ID = RB.ID AND WF.ACCTG\_TYPE\_ID = ACT.ID AND WF.SEC\_ATR\_VAL = ORG.ORG\_ID AND RCL.RC\_ID = RC.ID AND RCL.RC\_POB\_ID = POB.RC\_POB\_ID(+) AND RCL.BOOK\_ID = RC.BOOK\_ID AND ACT.WATERFALL\_FLAG = 'Y' AND ACT.COST\_FLAG = 'N' AND WF.PRD\_ID = CAL.ID AND WF.AS\_OF\_PRD\_ID = 201904 GROUP BY RB.NAME, ORG.ORG\_NAME, RC.ID, POB.RC\_POB\_NAME, RCL.CSTMR\_NM, RCL.SO\_BOOK\_DATE, RCL.SO\_NUM, RCL.SO\_LINE\_NUM, WF.ACCTG\_SEG, WF.ACCTG\_TYPE\_ID, ACT.NAME, CAL.PERIOD\_NAME, WF.PRD\_ID ORDER BY RB.NAME, RC.ID, RCL.SO\_NUM, RCL.SO\_LINE\_NUM, ACT.NAME, WF.PRD\_ID;

![cost-waterfall.png](https://zuora.deploy.heretto.com/v4/deployments/QPAZk6lsgXwvotedNERE/object/2dfe1af5-2b86-4e96-a6e9-8263bcc4a718?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJodHRwczovL2pvcnNlay5jb20vZXpkX29yZ2FuaXphdGlvbiI6Inp1b3JhIiwiaHR0cHM6Ly9qb3JzZWsuY29tL2V6ZC9vYmplY3RfdXVpZCI6IjJkZmUxYWY1LTJiODYtNGU5Ni1hNmU5LTgyNjNiY2M0YTcxOCIsImV4cCI6MTc3MTU1ODgyMywianRpIjoiZDljN2FkMThhMjZkNDg1OTg4YjhlM2JiZmVjYTJkYTMiLCJodHRwczovL2pvcnNlay5jb20vZXpkX2ZpbGVzZXQiOiJPbkFzQUJUb1lNdVNnalRaVHpuUCJ9.Hqbl70IMyAAJ1EexlPBLnZin8jCCzDthB_paeIcAhcQ) .

## RC rollforward

SELECT RB.NAME AS BOOK\_NAME, ORG.ORG\_NAME, RC.ID AS RC\_ID, POB.RC\_POB\_NAME, RCL.CSTMR\_NM, RCL.SO\_BOOK\_DATE, RCL.SO\_NUM, RCL.SO\_LINE\_NUM, CAL.PERIOD\_NAME, SUM(SUMM.F\_BB) as F\_BB, -- contract liability begin balance SUM(SUMM.F\_AD) as F\_AD, -- contract liability additions SUM(SUMM.F\_RL) as F\_RL, -- contract liability releases SUM(SUMM.F\_EB) as F\_EB, -- contract liability end balance SUM(SUMM.F\_AL\_BB) as F\_AL\_BB, -- liability adjustment begin balance SUM(SUMM.F\_AL\_AD) as F\_AL\_AD, -- liability adjustment additions SUM(SUMM.F\_AL\_RL) as F\_AL\_RL, -- liability adjustment releases SUM(SUMM.F\_AL\_EB) as F\_AL\_EB, -- liability adjustment end balance SUM(SUMM.F\_TL\_BB) as F\_TL\_BB, -- total liability adjustment begin balance SUM(SUMM.F\_TL\_AD) as F\_TL\_AD, -- total liability adjustment additions SUM(SUMM.F\_TL\_RL) as F\_TL\_RL, -- total liability adjustment releases SUM(SUMM.F\_TL\_EB) as F\_TL\_EB -- total liability adjustment end balance FROM RPRO\_BI3\_LN\_ACCT\_SUMM\_V SUMM, RPRO\_BI3\_ACCT\_TYPE\_V ACT, RPRO\_BI3\_RC\_LNS\_V RCL, RPRO\_BI3\_RC\_HEAD\_V RC, RPRO\_BI3\_RC\_POB\_V POB, RPRO\_BI3\_BOOK\_V RB, RPRO\_BI3\_ORG\_V ORG, RPRO\_BI3\_CALENDAR\_V CAL WHERE SUMM.ROOT\_LINE\_ID = RCL.ID AND SUMM.BOOK\_ID = RCL.BOOK\_ID AND SUMM.BOOK\_ID = RB.ID AND SUMM.ACCTG\_TYPE\_ID = ACT.ID AND SUMM.SEC\_ATR\_VAL = ORG.ORG\_ID AND RCL.RC\_ID = RC.ID AND RCL.RC\_POB\_ID = POB.RC\_POB\_ID(+) AND RCL.BOOK\_ID = RC.BOOK\_ID AND SUMM.PRD\_ID = CAL.ID AND SUMM.PRD\_ID = 201904 AND ACT.DEF\_REC\_FLAG in ('DEF', 'EDEF') GROUP BY RB.NAME, ORG.ORG\_NAME, RC.ID, POB.RC\_POB\_NAME, RCL.CSTMR\_NM, RCL.SO\_BOOK\_DATE, RCL.SO\_NUM, RCL.SO\_LINE\_NUM, CAL.PERIOD\_NAME ORDER BY RB.NAME, RC.ID, RCL.SO\_NUM, RCL.SO\_LINE\_NUM asc; .

## Revenue insight

SELECT RB.NAME AS BOOK\_NAME, ORG.ORG\_NAME, RC.ID AS RC\_ID, POB.RC\_POB\_NAME, RCL.CSTMR\_NM, RCL.SO\_BOOK\_DATE, RCL.SO\_NUM, RCL.SO\_LINE\_NUM, CAL.PERIOD\_NAME, SUM(SUMM.F\_AT) as F\_AT, -- revenue activity SUM(SUMM.F\_AR\_AT) as F\_AR, -- revenue adjustment SUM(SUMM.F\_TL\_AT) as F\_TL\_AT, -- total revenue activity SUM(SUMM.F\_TL\_AT\_PS) as F\_TL\_AT\_PS, -- total posted SUM(SUMM.F\_TL\_AT\_UN) as F\_TL\_AT\_UN -- total unposted FROM RPRO\_BI3\_LN\_ACCT\_SUMM\_V SUMM, RPRO\_BI3\_ACCT\_TYPE\_V ACT, RPRO\_BI3\_RC\_LNS\_V RCL, RPRO\_BI3\_RC\_HEAD\_V RC, RPRO\_BI3\_RC\_POB\_V POB, RPRO\_BI3\_BOOK\_V RB, RPRO\_BI3\_ORG\_V ORG, RPRO\_BI3\_CALENDAR\_V CAL WHERE SUMM.ROOT\_LINE\_ID = RCL.ID AND SUMM.BOOK\_ID = RCL.BOOK\_ID AND SUMM.BOOK\_ID = RB.ID AND SUMM.ACCTG\_TYPE\_ID = ACT.ID AND SUMM.SEC\_ATR\_VAL = ORG.ORG\_ID AND RCL.RC\_ID = RC.ID AND RCL.RC\_POB\_ID = POB.RC\_POB\_ID(+) AND RCL.BOOK\_ID = RC.BOOK\_ID AND SUMM.PRD\_ID = CAL.ID AND SUMM.PRD\_ID = 201904 AND ACT.DEF\_REC\_FLAG in ('REC', 'EREC') GROUP BY RB.NAME, ORG.ORG\_NAME, RC.ID, POB.RC\_POB\_NAME, RCL.CSTMR\_NM, RCL.SO\_BOOK\_DATE, RCL.SO\_NUM, RCL.SO\_LINE\_NUM, CAL.PERIOD\_NAME ORDER BY RB.NAME, RC.ID, RCL.SO\_NUM, RCL.SO\_LINE\_NUM asc;

![rc-rollforward.png](https://zuora.deploy.heretto.com/v4/deployments/QPAZk6lsgXwvotedNERE/object/d97c0366-3d2a-4521-beb6-596b42bf1837?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJodHRwczovL2pvcnNlay5jb20vZXpkX29yZ2FuaXphdGlvbiI6Inp1b3JhIiwiaHR0cHM6Ly9qb3JzZWsuY29tL2V6ZC9vYmplY3RfdXVpZCI6ImQ5N2MwMzY2LTNkMmEtNDUyMS1iZWI2LTU5NmI0MmJmMTgzNyIsImV4cCI6MTc3MTU1ODgyMywianRpIjoiYzVjYzQ2ZTdkMWE2NDM4ZDk4NzY1YTNhNTkwY2U5MDEiLCJodHRwczovL2pvcnNlay5jb20vZXpkX2ZpbGVzZXQiOiJPbkFzQUJUb1lNdVNnalRaVHpuUCJ9.__NMtiwAI6O1LFZjzHOAqcaY3fWluNerChA2PAJvLvI)

## MJE

SELECT MJE.JE\_HEAD\_ID, MJE.JE\_HEAD\_NAME, MJE.JE\_HEAD\_DESC, MJE.JE\_LINE\_ID, MJE.ACTIVITY\_TYPE, MJE.REASON\_CODE, MJE.DESCRIPTION, MJE.START\_DATE, MJE.END\_DATE, MJE.AMOUNT AS JE\_LINE\_AMOUNT, RC.ID AS RC\_ID, RCL.ID AS LINE\_ID, SCHD.ACCTG\_TYPE, SCHD.ACCTG\_SEG, SCHD.ACCOUNT\_NAME, C.PERIOD\_NAME AS SCHD\_POST\_PERIOD, SCHD.AMOUNT AS SCHD\_AMOUNT FROM RPRO\_BI3\_MJE\_V MJE, RPRO\_BI3\_RC\_SCHD\_V SCHD, RPRO\_BI3\_RC\_LNS\_V RCL, RPRO\_BI3\_RC\_HEAD\_V RC, RPRO\_BI3\_CALENDAR\_V C WHERE MJE.JE\_LINE\_ID = SCHD.LINE\_ID AND SCHD.ROOT\_LINE\_ID = RCL.ID AND RCL.RC\_ID = RC.ID AND RCL.BOOK\_ID = RC.BOOK\_ID AND SCHD.POST\_PRD\_ID = C.ID ORDER BY RC.ID, RCL.ID, SCHD.POST\_PRD\_ID;

![MJE.png](https://zuora.deploy.heretto.com/v4/deployments/QPAZk6lsgXwvotedNERE/object/ecd90677-c276-46d6-8c12-ff3160a2fc35?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJodHRwczovL2pvcnNlay5jb20vZXpkX29yZ2FuaXphdGlvbiI6Inp1b3JhIiwiaHR0cHM6Ly9qb3JzZWsuY29tL2V6ZC9vYmplY3RfdXVpZCI6ImVjZDkwNjc3LWMyNzYtNDZkNi04YzEyLWZmMzE2MGEyZmMzNSIsImV4cCI6MTc3MTU1ODgyMywianRpIjoiYWQ5YTZiOTEzY2FiNGJmZGE1OGFmOTQwOTE3MGQxMzEiLCJodHRwczovL2pvcnNlay5jb20vZXpkX2ZpbGVzZXQiOiJPbkFzQUJUb1lNdVNnalRaVHpuUCJ9.zGXrKe5XV2FkPIrtaQTjStefPbaYwzEmZBGCK-700Eg) .
